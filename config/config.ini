[CONFIGURATION]
#
# NOTE:
# - This file is grouped for readability. All '#' lines are comments.
# - Values are read from the [CONFIGURATION] section by TradingBot v4.11.3.
#

#  ==========================
# CORE RISK & POSITION SIZING
#  ==========================
# Maximum number of simultaneous open positions allowed (portfolio-wide).
max_positions = 5
# Maximum number of new entries the engine may open in one run/session window (wallet guard).
max_open_trades = 5
# Base dollar amount used for sizing entries (before compounding/AI sizing adjustments).
amount_to_trade = 2000
# Daily budget cap (USD) used by WalletManager for limiting total exposure/entries per day.
daily_budget = 1000
# Hard cap on position size as a fraction of account equity (e.g., 0.20 = 20%).
max_percent_per_stock = 0.20
# Maximum share/contract quantity allowed per order (final clamp after sizing).
max_qty = 100
# Minimum equity required to allow new entries (wallet guard).
min_equity = 1000
# Risk per trade as a percent (e.g., 1.0 = 1%). Used by risk-based sizing logic.
risk_per_trade_pct = 1.0
# Daily loss kill-switch in USD; engine should stop opening new risk beyond this threshold.
max_daily_loss = 100
# If True, amount_to_trade scales with account equity growth (paper/live).
compounding_enabled = True
# If True, position sizing may be scaled by AI confidence (ai_min_prob gate).
ai_sizing_enabled = True
agent_mode = OFF
agent_live_max_exposure_pct = 0.30
agent_max_live_changes_per_day = 8
# AI Agent operating mode: OFF (disabled), ADVISORY (no execution), PAPER, or LIVE.
agent_mode = OFF
# Hard cap for AI Agent proposed live exposure as a fraction of portfolio equity.
agent_live_max_exposure_pct = 0.30
# Maximum number of AI Agent live config/deployment changes allowed per day.
agent_max_live_changes_per_day = 8

#  ==========================
# ENGINE LOOP & DATA INGEST
#  ==========================
# Engine scan/update loop interval in seconds (UI speed dropdown uses this).
update_interval_sec = 60
# How many days of 1-minute bars Update DB should ensure exist in the DB window.
update_db_lookback_days = 30
# Extra minutes fetched before each missing-range window so EMA200/RSI/etc compute reliably.
indicator_warmup_minutes = 500
# Alpaca equity feed to use (e.g., iex, sip). Crypto ignores this setting.
equity_data_feed = iex
# SQLite path for market_data.db (relative paths are resolved from /TradingBot/config).
db_path = ..\db\market_data.db

#  ==========================
# MARKET REGIME FILTERS
#  ==========================
# Benchmark symbol used to classify market regime (default SPY).
market_regime_symbol = SPY
# ADX threshold below which the market is considered 'choppy' (filtering/trade gating).
regime_chop_adx_max = 18.0
# ATR%% threshold above which the market is considered 'high volatility'.
regime_highvol_atr_pct_min = 0.03

#  ==========================
# BACKTEST SETTINGS
#  ==========================
# Bars-to-live for limit entry simulation (cancel if not filled within this many bars).
backtest_entry_ttl_bars = 2
# When stop-loss and take-profit hit same bar: STOP_FIRST or TAKE_FIRST handling.
backtest_bar_conflict = STOP_FIRST
# Backtest slippage in basis points applied to fills (5 = 0.05%).
backtest_slippage_bps = 5
# Flat fee per trade (USD) used in backtest P/L calculations.
backtest_fee_per_trade = 0
# ATR multiple used to compute stop-loss distance in backtests.
backtest_atr_stop_mult = 2.0
# ATR multiple used to compute take-profit distance in backtests.
backtest_atr_take_mult = 3.0
# Maximum bars to hold a trade in backtest before forced exit.
backtest_max_hold_bars = 240
# Enable stagnation exit logic in backtest (time-based exit if price goes nowhere).
backtest_use_stagnation_exit = True
# Minutes without meaningful progress before stagnation exit triggers.
backtest_stagnation_minutes = 60
# Minimum gain threshold (fraction) considered acceptable under stagnation check.
backtest_stagnation_min_gain = -0.01
# Maximum gain threshold (fraction) where stagnation check still applies.
backtest_stagnation_max_gain = 0.003

#  ==========================
# GUARDIAN SAFETY RULES
#  ==========================
# If True, Guardian can force sells when sentiment is below threshold.
guardian_sell_on_negative_sentiment = False
# Sentiment threshold (e.g., -0.3) for Guardian negative sentiment actions.
guardian_sentiment_threshold = -0.3
# Enable stagnation exit logic during live/paper monitoring (Guardian).
guardian_use_stagnation_exit = True
# Minutes held with low movement before Guardian may exit for stagnation.
guardian_stagnation_minutes = 60
# Lower gain bound used in Guardian stagnation evaluation.
guardian_stagnation_min_gain = -0.01
# Upper gain bound used in Guardian stagnation evaluation.
guardian_stagnation_max_gain = 0.003

#  ==========================
# CONFIRMATION LOGIC
#  ==========================
# Number of consecutive confirmations required before an entry is allowed.
confirmation_required_hits = 2
# How long a confirmation signal remains valid (minutes).
confirmation_ttl_minutes = 10
# Minimum delay between confirmations (seconds) to avoid rapid-fire confirms.
confirmation_min_delay_seconds = 60

#  ==========================
# LIVE ORDER LIFECYCLE
#  ==========================
# If True, logs order state transitions (submitted/filled/cancelled/rejected).
log_order_lifecycle = True
# Live entry time-to-live (seconds) before cancelling unfilled entries.
live_entry_ttl_seconds = 120
# How often (seconds) to poll Alpaca order status during live entry management.
live_order_poll_interval_seconds = 5
# If True, cancel unfilled entry orders when TTL expires.
live_cancel_unfilled_entries = True

#  ==========================
# EXECUTION RECONCILIATION (v5.12.5)
#  ==========================
# How often (seconds) to reconcile broker positions/orders vs internal DB state.
reconcile_interval_seconds = 60
# Number of consecutive reconcile passes required before treating a mismatch as confirmed.
reconcile_confirmations = 2
# If True, halt new entries when a mismatch is detected until state is clean again.
reconcile_halt_on_mismatch = True

#  ==========================
# ARCHITECT TAB SETTINGS
#  ==========================
# Architect entry style preset (e.g., LIMIT_CLOSE_TTL) for optimizer simulations.
architect_entry_mode = LIMIT_CLOSE_TTL
# Architect entry TTL in bars for limit entries during optimization.
architect_entry_ttl_bars = 2
# Enable trailing stop exits for Architect optimization runs.
architect_use_trailing_stop = True
# If True, trailing stop percent is derived from stop-loss percent; otherwise use
# architect_trailing_stop_pct.
architect_trailing_uses_sl = True
# Trailing stop percent used when architect_trailing_uses_sl is False (e.g., 0.02 = 2%).
architect_trailing_stop_pct = 0.02
# Enable stagnation exit rules during Architect optimization.
architect_use_stagnation_exit = True
# Bars without progress before Architect stagnation exit triggers.
architect_stagnation_bars = 60
# Lower gain bound used for Architect stagnation exit.
architect_stagnation_min_gain = -0.01
# Upper gain bound used for Architect stagnation exit.
architect_stagnation_max_gain = 0.003
# If True, use ATR-based stop/take exits in Architect (overrides static % exits).
architect_use_atr_exits = False
# ATR multiple for Architect stop-loss distance.
architect_atr_stop_mult = 2.0
# ATR multiple for Architect take-profit distance.
architect_atr_take_mult = 3.0
# Maximum bars to hold a trade in Architect simulation.
architect_max_hold_bars = 200
# Minimum number of trades required for an Architect candidate to be considered valid.
architect_min_trades = 5
# Enable walk-forward evaluation inside Architect optimization (slower, more robust).
architect_use_walkforward = False
# Number of walk-forward splits for Architect (if enabled).
architect_walkforward_splits = 3
# When stop/take hit same bar in Architect: STOP_FIRST or TAKE_FIRST.
architect_bar_conflict = STOP_FIRST

#  ==========================
# LOGGING & OBSERVABILITY
#  ==========================
# Logging verbosity (DEBUG, INFO, WARN, ERROR).
log_level = INFO
# Interval (seconds) for periodic account/engine snapshot logs.
log_snapshot_interval_sec = 300
# If True, logs per-scan summary lines (candidates, decisions, etc.).
log_scan_summary = True
# If True, logs detailed candidate scoring lines (very verbose).
log_candidate_lines = False
# If True, logs why symbols were rejected (very verbose).
log_decision_rejects = False
# If True, logs a Guardian banner block each scan.
log_guardian_banner = False
# Enable writing logs to /TradingBot/logs files.
log_file_enabled = True
# Prefix for runtime log filename (e.g., RUNTIME).
log_file_prefix = RUNTIME
# If True, runtime log rolls daily (one per date).
log_file_roll_daily = True
# Max number of lines kept in the live log UI buffer.
log_max_lines = 2000

#  ==========================
# RUN SUMMARY & DATA FRESHNESS
#  ==========================
# If True, automatically retrain AI after Update DB completes.
ai_retrain_after_db_update = True
# If True, write JSON run summaries to /logs/summaries.
run_summary_enabled = True
# Prefix for run summary filenames (e.g., SUMMARY).
run_summary_prefix = SUMMARY
# Bars older than this (seconds) are considered stale for that symbol.
stale_bar_seconds_threshold = 180
# If True, logs stale assessment for each symbol (can be noisy).
stale_bar_log_each_symbol = False

#  ==========================
# E4 MULTI-TIMEFRAME + CLUSTERS
#  ==========================
# Master toggle for E4 (multi-timeframe regime + correlation clusters).
e4_enabled = True
# Enable multi-timeframe filters (e.g., 5Min/15Min) in E4.
e4_mtf_enabled = True
# Comma-separated timeframes used for multi-timeframe refresh (e.g., 5Min,15Min).
e4_mtf_timeframes = 5Min,15Min
# How often E4 refreshes multi-timeframe data (seconds).
e4_mtf_refresh_seconds = 120
# Fast EMA period used in multi-timeframe trend checks.
e4_mtf_ema_fast = 50
# Slow EMA period used in multi-timeframe trend checks.
e4_mtf_ema_slow = 200
# Minimum RSI threshold used as a momentum filter in multi-timeframe checks.
e4_mtf_rsi_min_momentum = 50
# Maximum simultaneous positions allowed per correlation cluster.
e4_max_positions_per_cluster = 1
# Cluster definition string (NAME:sym1,sym2|NAME2:symA,...) for correlated exposure limiting.
e4_correlation_clusters = TECH_LEVERAGED:TQQQ,SOXL|INVERSE_LEVERAGED:SQQQ,SOXS,SPXU|CRYPTO:BTC/USD,ETH/USD|CRYPTO_MINERS:MARA,COIN|FINTECH:HOOD,COIN

#  ==========================
# E5 WATCHDOG / HALT LOGIC
#  ==========================
# Master toggle for E5 watchdog/halt system.
e5_enabled = True
# If True, E5 enforcement is active in paper mode.
e5_enforce_on_paper = False
# If True, E5 enforcement is active in live mode.
e5_enforce_on_live = True
# How often the watchdog evaluates recent events (seconds).
e5_watchdog_interval_sec = 30
# Rolling window size (seconds) for counting events (rejects, API errors, TTL cancels).
e5_event_window_sec = 900
# Max order rejects allowed within window before watchdog triggers.
e5_max_rejects_in_window = 10
# Max API errors allowed within window before watchdog triggers.
e5_max_api_errors_in_window = 20
# Max TTL cancels allowed within window before watchdog triggers.
e5_max_ttl_cancels_in_window = 20
# If True, watchdog halt cancels pending orders.
e5_halt_cancel_pending_orders = True
# If True, watchdog halt liquidates positions (high risk; use carefully).
e5_halt_liquidate = False
# If True, watchdog halt stops the engine loop.
e5_halt_stop_engine = False

#  ==========================
# PROMOTION (PAPER → LIVE)
#  ==========================
# Enable paper → live promotion evaluation and reporting.
promotion_enabled = True
# Minimum number of paper sessions required before promotion is considered.
promotion_min_sessions = 5
# Minimum total paper trades required before promotion is considered.
promotion_min_trades_total = 30
# (Reserved) Minimum trades per symbol for promotion (may not be enforced in current code).
promotion_min_trades_per_symbol = 3
# Max allowed drawdown (percent) over the promotion window.
promotion_max_drawdown_pct = 4.0
# Max allowed daily loss (percent) over the promotion window.
promotion_max_daily_loss_pct = 2.0
# Max allowed cancel rate (percent) over the promotion window.
promotion_max_cancel_rate_pct = 35.0
# Max allowed reject rate (percent) over the promotion window.
promotion_max_reject_rate_pct = 10.0
# Max allowed API errors per hour before promotion fails.
promotion_max_api_errors_per_hour = 20
# Require zero stale symbols during the promotion window.
promotion_require_no_stale_symbols = True
# (Reserved) Stale threshold override for promotion checks (may not be enforced).
promotion_stale_threshold_seconds = 180
# Require no detected crashes during the promotion window.
promotion_require_no_crashes = True
# Require no watchdog halts during the promotion window.
promotion_require_no_watchdog_halts = True
# Lookback window (days) used for promotion evaluation.
promotion_window_days = 30
# (Reserved) Initial live sizing fraction after promotion (may not be enforced).
promotion_live_start_fraction = 0.25
# (Reserved) Days to scale live sizing from start_fraction to full (may not be enforced).
promotion_live_scale_days = 5

#  ==========================
# AI TRAINING (V2)
#  ==========================
# Minimum AI probability required to allow an entry (gate).
ai_min_prob = 0.50
# Label horizon in bars (future window) used to build AI training labels.
ai_label_horizon_bars = 60
# Take-profit ATR multiple used in AI label generation.
ai_label_tp_atr_mult = 1.5
# Stop-loss ATR multiple used in AI label generation.
ai_label_sl_atr_mult = 1.0
# Minimum return threshold used for positive label classification.
ai_label_min_return_pct = 0.001
# Max rows per symbol used for AI training (caps training time/memory).
ai_train_limit_per_symbol = 20000
# Minimum total training rows required to train (otherwise 'not enough data').
ai_min_train_rows = 2000
# Walk-forward splits used for AI evaluation/training (higher = slower).
ai_walkforward_splits = 3
# Probability calibration method: sigmoid or isotonic.
ai_calibration_method = sigmoid
# Fraction of training data reserved for calibration (0.0–1.0).
ai_calibration_frac = 0.2
# Alias for ai_calibration_frac (kept for backward compatibility).
ai_calibration_fraction = 0.2
# RandomForest n_estimators (more = slower, potentially smoother).
ai_rf_estimators = 200
# RandomForest min_samples_leaf (higher = smoother, less overfit).
ai_rf_min_leaf = 5

#  ==========================
# AUTO-ADDED DEFAULTS (preserve comments)
#  ==========================
# Database mode: 'single' uses market_data.db; 'split' uses separate *.db files (Update A).
db_mode = split
# Directory for split DB files when db_mode='split'. Relative paths resolve from TradingBot\config\.
db_dir = ..\db
#  ==========================
# AUTO-ADDED DEFAULTS (preserve comments)
#  ==========================
# If db_mode='split' and market_data.db exists, auto-migrate tables into split DBs at startup (Update B).
db_auto_migrate_on_startup = False
#  ==========================
# AUTO-ADDED DEFAULTS (preserve comments)
#  ==========================
# Enable AI-driven automatic tuning of CONFIGURATION values (currently foundation only).
config_auto_update_enabled = False
# Record config changes into the database (config_history table).
config_history_enabled = True
# Max rows to keep in config_history (old rows pruned when exceeded).
config_history_max_rows = 5000
#  ==========================
# AUTO-ADDED DEFAULTS (preserve comments)
#  ==========================
# Auto-added default setting.
candidate_scanner_enabled = True
# Auto-added default setting.
candidate_scanner_universe_mode = WATCHLIST
# Auto-added default setting.
candidate_scanner_universe = 
# Auto-added default setting.
candidate_scanner_limit = 20
# Auto-added default setting.
candidate_scanner_lookback_bars = 390
# Auto-added default setting.
candidate_scanner_min_bars = 120
# Auto-added default setting.
candidate_scanner_min_dollar_volume = 1000000
# Auto-added default setting.
candidate_scanner_score_mode = simple
# Auto-added default setting.
candidate_scanner_include_negative_movers = True
#  ==========================
# AUTO-ADDED DEFAULTS (preserve comments)
#  ==========================
# Enable periodic auto-update of WATCHLIST based on today's candidates (defaults OFF).
watchlist_auto_update_enabled = False
# Auto-update interval in minutes (periodic).
watchlist_auto_update_interval_min = 30
# Watchlist update mode: ADD (append top candidates) or REPLACE (overwrite non-crypto portion).
watchlist_auto_update_mode = ADD
# When mode=ADD, max number of symbols to add per run (0 = unlimited).
watchlist_auto_update_max_add = 5
# Hard cap on total watchlist size after policy is applied.
watchlist_auto_update_max_total = 20
# Minimum candidate score required to be added to watchlist.
watchlist_auto_update_min_score = 0.0
# Enable crypto stable set selection (liquidity/spread filtered).
crypto_stable_set_enabled = False
# When crypto stable set is enabled, replace existing crypto entries in the watchlist.
crypto_stable_set_replace_existing = True
# Lookback bars used to compute crypto liquidity proxy.
crypto_stable_set_lookback_bars = 390
# Minimum dollar-volume over lookback window for crypto inclusion.
crypto_stable_set_min_dollar_volume = 5000000
# Maximum allowed spread (%). Falls back to a range-based proxy if quotes are unavailable.
crypto_stable_set_max_spread_pct = 0.5
# How many crypto symbols to keep in the stable set.
crypto_stable_set_max_assets = 6

#  ==========================
# AUTO-ADDED DEFAULTS (preserve comments)
#  ==========================
# Start the UI in miniplayer mode (Live Log focused).
miniplayer_enabled = False
# Normal UI refresh cadence for the main UI loop (milliseconds).
ui_refresh_ms = 2000
# Miniplayer UI refresh cadence (milliseconds). Slower = lower CPU.
miniplayer_ui_refresh_ms = 8000
