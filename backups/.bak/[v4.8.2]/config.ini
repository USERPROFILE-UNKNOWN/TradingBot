[CONFIGURATION]

#  ==========================
# CORE RISK + POSITIONING
#  ==========================
# Maximum number of concurrent open positions allowed.
max_positions = 5
# Dollar amount allocated per new position (base sizing before any scaling).
amount_to_trade = 2000
# Hard cap for any single position as a fraction of total equity (0.20 = 20%).
max_percent_per_stock = 0.20
# Absolute daily loss kill-switch in USD (used by E5 kill-switch logic).
max_daily_loss = 100
# If True, position sizing can grow as equity grows; if False, sizing stays fixed.
compounding_enabled = True
# If True, AI can influence position sizing (if your engine uses AI sizing); if False, AI is advisory/veto only.
ai_sizing_enabled = True

#  ==========================
# ENGINE LOOP + DATA UPDATE
#  ==========================
# Main scan/update loop interval in seconds.
update_interval_sec = 60
# How many days of 1-minute candles UPDATE DB pulls per symbol (clamped by code).
update_db_lookback_days = 365
# Alpaca equities feed to use (iex recommended for free-tier; sip requires subscription).
equity_data_feed = iex
# SQLite database path (relative to config folder is supported; keep consistent with your folder layout).
db_path = ..\db\market_data.db

#  ==========================
# BACKTEST LAB SETTINGS
#  ==========================
# Backtest entry TTL in bars (how many bars a limit entry is allowed to sit before cancel).
backtest_entry_ttl_bars = 2
# When both stop and take-profit are hit in the same bar, which resolves first (STOP_FIRST or TAKE_FIRST).
backtest_bar_conflict = STOP_FIRST
# Backtest slippage approximation in basis points (5 bps = 0.05%).
backtest_slippage_bps = 5
# Flat fee per trade in USD (0 if ignored).
backtest_fee_per_trade = 0
# ATR stop multiplier for backtest exits (if ATR exits are enabled in backtest logic).
backtest_atr_stop_mult = 2.0
# ATR take-profit multiplier for backtest exits (if ATR exits are enabled in backtest logic).
backtest_atr_take_mult = 3.0
# Maximum holding duration in bars before force exit (240 bars = 4 hours on 1m).
backtest_max_hold_bars = 240
# If True, enable stagnation-based exit (exit if price fails to move meaningfully).
backtest_use_stagnation_exit = True
# Stagnation window in minutes used by stagnation exit.
backtest_stagnation_minutes = 60
# Minimum gain threshold for stagnation exit (negative allows small drawdown tolerance).
backtest_stagnation_min_gain = -0.01
# Maximum gain threshold for stagnation exit (exits if too flat/low progress).
backtest_stagnation_max_gain = 0.003

#  ==========================
# GUARDIAN / SAFETY FILTERS
#  ==========================
# If True, force sell/avoid holding when sentiment is below threshold (news-based guardian).
guardian_sell_on_negative_sentiment = False
# Sentiment threshold below which guardian considers news "negative" (e.g., -0.3).
guardian_sentiment_threshold = -0.3
# If True, guardian can exit positions on stagnation conditions (runtime, not backtest).
guardian_use_stagnation_exit = True
# Guardian stagnation window in minutes.
guardian_stagnation_minutes = 60
# Minimum gain threshold for guardian stagnation logic.
guardian_stagnation_min_gain = -0.01
# Maximum gain threshold for guardian stagnation logic.
guardian_stagnation_max_gain = 0.003

#  ==========================
# CONFIRMATION ENGINE
#  ==========================
# Number of confirmation hits required before an entry is allowed.
confirmation_required_hits = 2
# Minutes before a confirmation "candidate" expires if not confirmed.
confirmation_ttl_minutes = 10
# Minimum delay between confirmation hits in seconds (prevents spam confirmations).
confirmation_min_delay_seconds = 60

#  ==========================
# LIVE ORDER LIFECYCLE
#  ==========================
# If True, logs detailed order lifecycle events (submit/partial/fill/cancel/reject).
log_order_lifecycle = True
# Entry order TTL in seconds (cancel if not filled within this time).
live_entry_ttl_seconds = 120
# Poll interval in seconds to refresh order status while waiting for fills.
live_order_poll_interval_seconds = 5
# If True, automatically cancel unfilled entry orders after TTL.
live_cancel_unfilled_entries = True

#  ==========================
# ARCHITECT TAB SETTINGS
#  ==========================
# Architect entry mode (example: LIMIT_CLOSE_TTL).
architect_entry_mode = LIMIT_CLOSE_TTL
# Architect entry TTL in bars (limit order validity window).
architect_entry_ttl_bars = 2
# If True, use a trailing stop in Architect simulations.
architect_use_trailing_stop = True
# If True, trailing stop uses stop-loss mechanics internally (vs take-profit trailing).
architect_trailing_uses_sl = True
# If True, use stagnation-based exits in Architect simulations.
architect_use_stagnation_exit = True
# Stagnation window in bars for Architect.
architect_stagnation_bars = 60
# Minimum gain threshold for Architect stagnation exit.
architect_stagnation_min_gain = -0.01
# Maximum gain threshold for Architect stagnation exit.
architect_stagnation_max_gain = 0.003
# If True, enable ATR stop/take exits in Architect.
architect_use_atr_exits = False
# ATR stop multiplier in Architect.
architect_atr_stop_mult = 2.0
# ATR take-profit multiplier in Architect.
architect_atr_take_mult = 3.0
# Maximum holding duration in bars for Architect.
architect_max_hold_bars = 200
# Minimum number of trades required for Architect evaluation validity.
architect_min_trades = 5
# If True, enables walk-forward testing in Architect.
architect_use_walkforward = False
# Number of walk-forward splits if enabled.
architect_walkforward_splits = 3
# Conflict resolution when stop/take hit same bar (STOP_FIRST or TAKE_FIRST).
architect_bar_conflict = STOP_FIRST

#  ==========================
# LOGGING + OBSERVABILITY
#  ==========================
# Log verbosity (DEBUG, INFO, WARNING, ERROR).
log_level = INFO
# Snapshot log interval in seconds (periodic state snapshot logging).
log_snapshot_interval_sec = 300
# If True, prints per-scan summary lines (counts, winners, etc.).
log_scan_summary = True
# If True, prints detailed candidate scoring lines (noisy).
log_candidate_lines = False
# If True, logs explicit reasons for rejecting trades (useful for debugging gates).
log_decision_rejects = False
# If True, logs guardian banners/status (sentiment & exits).
log_guardian_banner = False
# If True, writes logs to a file under /logs.
log_file_enabled = True
# Prefix used for runtime log filenames.
log_file_prefix = RUNTIME
# If True, rolls logs daily.
log_file_roll_daily = True
# Max number of UI log lines retained in the Live Log widget.
log_max_lines = 2000

#  ==========================
# AI TRAINING / RETRAINING
#  ==========================
# If True, retrain the AI model after a successful UPDATE DB run.
ai_retrain_after_db_update = True

#  ==========================
# RUN SUMMARY EXPORT (E3)
#  ==========================
# If True, enables exporting standardized summary JSON into logs/summaries.
run_summary_enabled = True
# (Legacy) Summary prefix key; standardized naming is still used by v4.8.2 regardless.
run_summary_prefix = SUMMARY
# Stale data threshold in seconds (symbol considered stale if last bar older than this).
stale_bar_seconds_threshold = 180
# If True, logs stale status for each symbol (can be noisy).
stale_bar_log_each_symbol = False

#  ==========================
# DIVERSIFICATION FRAMEWORK (E4)
#  ==========================
# Master toggle for E4 gating (correlation clusters + MTF filters).
e4_enabled = True
# If True, enables Multi-Timeframe confirmation gating (5m/15m context).
e4_mtf_enabled = True
# Timeframes used for MTF gating (comma-separated).
e4_mtf_timeframes = 5Min,15Min
# Refresh cadence (seconds) for MTF cached bars.
e4_mtf_refresh_seconds = 120
# Fast EMA length used on higher timeframes for trend confirmation.
e4_mtf_ema_fast = 50
# Slow EMA length used on higher timeframes for trend confirmation.
e4_mtf_ema_slow = 200
# Minimum RSI threshold used as a momentum confirmation gate (when applicable).
e4_mtf_rsi_min_momentum = 50
# Maximum number of open positions allowed within a single correlation cluster.
e4_max_positions_per_cluster = 1
# Correlation clusters format:
# CLUSTER_NAME:SYM1,SYM2|CLUSTER2:SYM3,SYM4|...
# NOTE: Avoid listing the same symbol in multiple clusters (first match typically wins).
e4_correlation_clusters = TECH_LEVERAGED:TQQQ,SOXL|INVERSE_LEVERAGED:SQQQ,SOXS,SPXU|CRYPTO:BTC/USD,ETH/USD|CRYPTO_MINERS:MARA,COIN|FINTECH:HOOD,COIN

#  ==========================
# SAFEGUARDS / WATCHDOG (E5)
#  ==========================
# Master toggle for E5 watchdog + kill-switch behaviors.
e5_enabled = True
# If True, watchdog enforcement is active in paper mode (recommended False for early testing).
e5_enforce_on_paper = False
# If True, watchdog enforcement is active in live mode (recommended True).
e5_enforce_on_live = True
# Watchdog evaluation interval (seconds).
e5_watchdog_interval_sec = 30
# Rolling event window length (seconds) used for counting rejects/errors/cancels.
e5_event_window_sec = 900
# Maximum order rejects allowed within the event window before halting new entries.
e5_max_rejects_in_window = 10
# Maximum API errors allowed within the event window before halting new entries.
e5_max_api_errors_in_window = 20
# Maximum TTL cancels allowed within the event window before halting new entries.
e5_max_ttl_cancels_in_window = 20
# If True, cancel pending entry orders when watchdog halts new entries.
e5_halt_cancel_pending_orders = True
# If True, liquidate positions when watchdog halts (high risk; recommended False until proven).
e5_halt_liquidate = False
# If True, stop engine when watchdog halts (leaves UI open but stops trading loop).
e5_halt_stop_engine = False

#  ==========================
# PROMOTION RULES (paper -> live) (v4.8.2)
#  ==========================
# If True, promotion_status is computed and included in summary JSON.
promotion_enabled = True
# Number of most recent PAPER sessions to evaluate for promotion decisions.
promotion_min_sessions = 5
# Minimum total trades across the evaluated sessions.
promotion_min_trades_total = 30
# Minimum trades per symbol across the evaluated sessions (helps avoid “one-symbol” bias).
promotion_min_trades_per_symbol = 3
# Maximum allowed drawdown percentage across evaluated sessions (proxy; depends on summary metrics).
promotion_max_drawdown_pct = 4.0
# Maximum allowed daily loss percentage across evaluated sessions (proxy; depends on summary metrics).
promotion_max_daily_loss_pct = 2.0
# Maximum allowed cancel rate percentage (e.g., 35.0 means <= 35% cancels).
promotion_max_cancel_rate_pct = 35.0
# Maximum allowed reject rate percentage (e.g., 10.0 means <= 10% rejects).
promotion_max_reject_rate_pct = 10.0
# Maximum allowed API errors per hour (proxy; derived from summary watchdog/error counts).
promotion_max_api_errors_per_hour = 20
# If True, promotion fails if any symbol is stale during market-hours session windows.
promotion_require_no_stale_symbols = True
# Stale threshold (seconds) used for promotion-specific stale evaluation (can match stale_bar_seconds_threshold).
promotion_stale_threshold_seconds = 180
# If True, promotion fails if a crash marker is detected (if your summary includes crash flags).
promotion_require_no_crashes = True
# If True, promotion fails if watchdog halts occurred in evaluated sessions.
promotion_require_no_watchdog_halts = True
# Only consider summaries within this rolling time window (days) when computing promotion_status.
promotion_window_days = 30
# Fractional sizing to use at first live promotion stage (0.25 = 25% size).
promotion_live_start_fraction = 0.25
# Days to scale from start fraction to full size (staged live rollout).
promotion_live_scale_days = 5
